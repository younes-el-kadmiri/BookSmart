{% extends "base.html" %}
{% block title %}Catalogue - Bib Readers{% endblock %}
{% block content %}
<section class="hero">
  <h1>Catalogue</h1>
  <p class="muted">Recherche par titre ou catégorie.</p>
  <div class="row">
    <input id="search" class="input" placeholder="Ex: Sapiens, The Requiem Red…">
    
    <!-- Select pour la catégorie -->
    <select id="category" class="input">
      <option value="">Toutes les catégories</option>
      <option value="Books">Books</option>
      <option value="Travel">Travel</option>
      <option value="Mystery">Mystery</option>
      <option value="Historical Fiction">Historical Fiction</option>
      <option value="Sequential Art">Sequential Art</option>
      <option value="Classics">Classics</option>
      <option value="Philosophy">Philosophy</option>
      <option value="Romance">Romance</option>
      <option value="Womens Fiction">Womens Fiction</option>
      <option value="Fiction">Fiction</option>
      <option value="Childrens">Childrens</option>
      <option value="Religion">Religion</option>
      <option value="Nonfiction">Nonfiction</option>
      <option value="Music">Music</option>
      <option value="Default">Default</option>
      <option value="Science Fiction">Science Fiction</option>
      <option value="Sports and Games">Sports and Games</option>
      <option value="Fantasy">Fantasy</option>
      <option value="New Adult">New Adult</option>
      <option value="Young Adult">Young Adult</option>
      <option value="Science">Science</option>
      <option value="Poetry">Poetry</option>
      <option value="Paranormal">Paranormal</option>
      <option value="Art">Art</option>
      <option value="Psychology">Psychology</option>
      <option value="Autobiography">Autobiography</option>
      <option value="Parenting">Parenting</option>
      <option value="Adult Fiction">Adult Fiction</option>
      <option value="Humor">Humor</option>
      <option value="Horror">Horror</option>
      <option value="History">History</option>
      <option value="Food and Drink">Food and Drink</option>
      <option value="Christian Fiction">Christian Fiction</option>
      <option value="Business">Business</option>
      <option value="Biography">Biography</option>
      <option value="Thriller">Thriller</option>
      <option value="Contemporary">Contemporary</option>
      <option value="Spirituality">Spirituality</option>
      <option value="Academic">Academic</option>
      <option value="Self Help">Self Help</option>
      <option value="Historical">Historical</option>
      <option value="Christian">Christian</option>
      <option value="Suspense">Suspense</option>
      <option value="Short Stories">Short Stories</option>
      <option value="Novels">Novels</option>
      <option value="Health">Health</option>
      <option value="Politics">Politics</option>
      <option value="Cultural">Cultural</option>
      <option value="Erotica">Erotica</option>
      <option value="Crime">Crime</option>
    </select>
    <select id="genre">
        <option value="">Tous genres</option>
        <option value="Fiction">Fiction</option>
        <option value="Nonfiction">Nonfiction</option>
        <option value="Fantasy">Fantasy</option>
  </select>

    <button class="btn primary" onclick="searchBooks()">Rechercher</button>
    <a class="btn ghost" href="#" onclick="searchBooks(); return false;">Tout afficher</a>
</div>
</section>

<section class="section">
  <div id="books-grid" class="grid"></div>
</section>
{% endblock %}

{% block scripts %}
<script>
// au chargement, liste initiale
searchBooks('search','books-grid').catch(()=>{});

// Modifier la fonction searchBooks pour prendre la catégorie
function searchBooks() {
  const query = document.getElementById('search').value;
  const category = document.getElementById('category').value;
  const grid = document.getElementById('books-grid');

  // exemple simple, tu peux adapter avec ton API backend
  fetch(`/livres/search/?q=${encodeURIComponent(query)}&category=${encodeURIComponent(category)}`)
    .then(res => res.json())
    .then(data => {
      grid.innerHTML = '';
      data.forEach(book => {
        const div = document.createElement('div');
        div.className = 'book-card';
        div.innerHTML = `<h3>${book.titre}</h3><p>${book.auteur}</p>`;
        grid.appendChild(div);
      });
    });
}
</script>
{% endblock %}
